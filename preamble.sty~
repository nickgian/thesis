\usepackage{fontenc}[T1]

\usepackage[american]{babel}

% \usepackage{microtype}
\usepackage{amsmath,amssymb,amsthm}

\usepackage{aliascnt} %% using a single counter and still get autoref to work

\theoremstyle{definition}
\newtheorem{dummy}{***}[section] % [subsection] for within subsections
\newcommand{\mynewtheorem}[2]{
  \newaliascnt{#1}{dummy}
  \newtheorem{#1}[#1]{#2}
  \aliascntresetthe{#1}
  % maybe we will squish some autoref defaults, but who cares?
  \expandafter\def\csname #1autorefname\endcsname{#2}
}
\mynewtheorem{defn}{Definition}
\mynewtheorem{lemma}{Lemma}
\mynewtheorem{thm}{Theorem}
\mynewtheorem{cor}{Corollary}

% \usepackage{stmaryrd}
% \usepackage{supertabular}
% % \usepackage{fullpage}
\usepackage{ifthen}
\usepackage{ifmtarg}
\usepackage{xcolor}
\usepackage{xspace}
% \usepackage{listings}
% \usepackage{fancyvrb}
% \usepackage{bussproofs}
% \usepackage{mathpartir}
\usepackage{graphicx}
%% \usepackage{bcptheorem}
\usepackage{bcprules}
\setlength{\afterruleskip}{\medskipamount}
\usepackage{morefloats}
%% \setlength{\afterruleskip}{\medskipamount}
%\usepackage{fnpct} % adjacent footnotes, compatible with hyperref
                    % but not working on APT's machine
\usepackage[normalem]{ulem}
\usepackage[
    pdftex,%
    pdfpagelabels,%
    colorlinks,%
    linkcolor=blue,%
    citecolor=blue,%
    filecolor=blue,%
    urlcolor=blue%
\ifbackref,backref\fi%
]{hyperref}
\def\Snospace苡茚滗麸苠趄狍犴弪殂犷翳徜漪铄邃邃麸磲脲忉忮栳痧茕彐荏邈糸镱狨麸蝈骖犴妍苡铒箴徙妪茕彐荏踱箦泗轱钺豸矧彐钺礤苡铒箴徙妪茕彐荏踱篚怏邈糸镱狨麸蝈骖犴妍苡铒箴徙妪茕彐苕殓躜遽豸矧彐钺礤崎绠ゥ茴鬻泔眄犷洫荇桧狨麸蝈骖犴妪澡屣蝈睚ゥ茴鬻泔眄犷洫茕彐钺豸矧彐钺礤腻骈铋糸镱ゥ茴鬻泔眄犷洫莒屙磲狨麸蝈骖犴妪体眄猃荃箦疳汶徵妍怙镫翎怏荃箦疳汶徵妍翎怩灬蝤茴鬻泔祯眍豉疱睚郾蓰钧１见蔑祜蝮茕彐轭邈镬矧潆忪蹂蜱恺艾爱爆爱谍茕彐轭邈镬矧潆珧邋铨蜱恺艾爱船褒茕彐轭邈镬矧潆蝈潺蜱恺爱冬艾褒茕彐轭邈镬矧潆瘐蝠戾蜱恺爱番艾爱待茕彐轭邈镬矧镬轹妪蜱恺爱惮爱惮爱褒茕彐轭邈镬矧翦犰蜱恺爱艾爱惮爱谍蔑眄孱趔莒镱畿溴孳泔眄孱簦丙茴鬻泔眄犷潲苕轭轶椠郾蓰荛驿蜥骠荇屮翥镬矧珧狴郏陛苕辇茴鬻泔眄犷潲芷晌捎三郾蓰荛驿蜥骠荇屮翥镬矧忪蹂郏陛苕辇茴鬻泔眄犷潲苕邋溻徙臊郾蓰荛驿蜥骠荇屮翥镬矧潆忪蹂郏陛苕辇茴鬻泔眄犷潲茯弼殄鼾郾蓰荛驿蜥骠荇屮翥镬矧潆忪蹂垡弼殄骱１蔟苕辇茴鬻泔眄犷潲苠篝轫狒妪郾蓰荛驿蜥骠茔镬矧蝈潺郏陛苕辇茴鬻泔眄犷潲茔镯睚鄢蓰荛驿蜥骠茔镬矧１郏埠３蔟苕辇茴鬻泔眄犷潲茆沭郾蓰茔镯睇潆瘐蝠戾旅旋１茴鬻泔眄犷潲茆沭蜗郾蓰茔镯睇潆瘐蝠戾旅旋茆１茴鬻泔眄犷潲茔椠郾蓰茔镯睇潆珧邋铨萌１冕翎扉茴鬻泔眄犷潲茔栉献郾蓰茔镯睇潆珧邋铨萌茆１冕翎扉茴鬻泔眄犷潲茕潺郾蓰茔镯睇鲩镬弭哪１腻祓栝铄茴鬻泔眄犷潲茚痿郾蓰茔镯睇潆蝈潺列札１令潋鬻茴鬻泔眄犷潲茴泯郾蓰茔镯睇矧犷珏蚊１吾翳犷茴鬻泔眄犷潲茚後郾蓰茔镯睇忪蹂亮笼１硫翳躜茴鬻泔眄犷潲茯狃郾蓰茔镯睇磲珏铘猃伊旋１裔钿茴鬻泔眄犷潲茚礓郾蓰茔镯睇翦犰镣凝１令潋茴鬻泔眄犷潲荜眢郾蓰茔镯睇蝈潺释育１释茴鬻泔眄犷潲茚礓蝈鳊郾蓰茔镬矧翦犰１令潋茴鬻泔眄犷潲茕痤郾蓰茔镯睇镬轹妪男１尼鲩茴鬻泔眄犷潲茚篾郾蓰茔镯睇怛秣铨劣邶１令翎茴鬻泔眄犷潲茯邂郾蓰茔镯睇蝈潺义怩趑犰１蝈怩趑犰茴鬻泔眄犷潲茜獒铨郾蓰茔镯睇潆忪蹂吻１伍汶茴鬻泔眄犷潲茼潺郾蓰茔镯睇泫犷湍１歪轫蕊蜷镱翎怛徙脲趔ㄦ蝻令澌签茴鬻泔眄犷潲荑怛猃荑怙麸茔镬蹴铟殇翳荟蝓戾鏖漪璋稠桢殓梏碑疙溴痿璀爱稠莒遽溴蝮荑蝓戾桢殓梏碑疙溴痿璀碑淀碥桄殪荟蝓戾鏖漪璋稠桢殓梏碑疙溴痿璀爱稠睚茴鬻泔眄犷潲荑脲酏荑怙麸茔镬蹴铟殇翳荟蝓戾鏖漪璋稠桢殓梏碑淀莒遽溴蝮荑蝓戾桢殓梏爱稠碥桄殪荟蝓戾鏖漪璋稠桢殓梏碑淀睚茴鬻泔眄犷洫芘驱瀹绠茗箴徙妪茴鬻泔眄犷洫苌琵楫瀹茗箴徙妪茴鬻泔眄犷洫芘粤听苠弭犰茗箴徙妪茴鬻泔眄犷洫芘悦弭惝茗箴徙妪茴鬻泔眄犷洫苡疗琵恿婆显犷塘耘磲泸矬骘忮趑弪珧犷蹯狎轸茴鬻泔眄犷潲荞嵊翦瘕鄯蓰茕彐茚蝌狴篝蝈翥棼饼荏弭戾铉翳茚蝌狴泔祗屦拆酏茆彗轭狎蜥祢煦１２３茗蜷玷翎蝌秣４苘５６７苠钿狎蜥茴鬻泔眄犷潲茚郁屦鄹蓰芾殒眙狎琨８１芑２芑３芑茗蜷玷翎蝌秣４芑５芑６芑７茕彐茚蝌狴篝蝈翥棼饼荏弭戾铉翳茚蝌狴泔祗屦拆酏茆彗轭狎蜥祢煦１２３茗蜷玷翎蝌秣４苘５６７苠钿狎蜥茴鬻泔眄犷潲茔郁屦酃蓰茕彐芰蜱甥１茕彐芰蜱缮２茕彐芰蜱缮甥３茕彐芰蜱芍４茕彐芰蜱蛀５茕彐芰蜱稚６茕彐芰蜱稚甥７茕彐芰蜱稚缮８茕彐芰蜱韶９茔郁屦蔑铘轭蹂茴鬻泔眄犷潲茔郁屦蔑铘轭蹂鄢蓰茕彐芰蜱佧１茕彐芰蜱厣２芾殒眙狎琨３芰蜱芑芰蜱缮芑芰蜱缮芑芰蜱芍芑芰蜱茗蜷玷翎蝌秣芰蜱稚芑芰蜱稚芑芰蜱稚缮芑芰蜱韶芑芰蜱芑芰蜱厣茕彐茚蝌狴篝蝈翥棼饼荏弭戾铉翳茚蝌狴泔祗屦拆酏茆彗轭狎蜥煦祢煦芰蜱芰蜱缮芰蜱缮芰蜱芍芰蜱茗蜷玷翎蝌秣芰蜱稚苘芰蜱稚芰蜱稚缮芰蜱韶芰蜱芰蜱厣苠钿狎蜥茴鬻泔眄犷潲茔逵翦瘕酃蓰茕彐芰蜱甥１茕彐芰蜱缮２茕彐芰蜱缮甥３茕彐芰蜱芍４茕彐芰蜱蛀５茕彐芰蜱稚６茕彐芰蜱稚甥７茕彐芰蜱稚缮８茕彐芰蜱韶９茔逵翦鹈镱糸铛茴鬻泔眄犷潲茔逵翦鹈镱糸铛妪郾蓰芾殒眙狎琨１芰蜱芑芰蜱缮芑芰蜱缮芑芰蜱芍茗蜷玷翎蝌秣芰蜱铸芑芰蜱稚芑芰蜱稚芑芰蜱稚缮芑芰蜱韶茕彐茚蝌狴篝蝈翥棼饼荏弭戾铉翳茚蝌狴泔祗屦拆酏茆彗轭狎蜥煦祢泯芰蜱芰蜱缮芰蜱缮芰蜱芍茗蜷玷翎蝌秣芰蜱铸苘芰蜱稚芰蜱稚芰蜱稚缮芰蜱韶苠钿狎蜥ゥゥゥ义躞轭翳轶翦忪徙磲玳骘蝓铙燥朋汜疱茴鬻泔眄犷潲莛蜷鲶翦痼苠铙躜屙狒荇镞荏臊摞荏翎螨茴鬻泔眄犷潲茯躅笤锱筱狃妪酃蓰茕彐芰蜱甥１茕彐芰蜱缮２茕彐芰蜱缮甥３茕彐芰蜱芍４茕彐芰蜱蛀５茕彐芰蜱稚６胖盼轭皿翦茕彐芰蜱稚甥７茕彐芰蜱稚缮８茕彐芰蜱韶９茯躅笤锱筱狃迕镱糸铛茴鬻泔眄犷潲茯躅笤锱筱狃迕镱糸铛妪鄄蓰茕彐芰蜱佧１芾殒眙狎琨２芰蜱芑芰蜱缮芑芰蜱缮芑芰蜱芍芑芰蜱莛蜷鲶翦痼芰蜱稚芑芰蜱稚芑芰蜱稚缮芑芰蜱韶芑芰蜱茕彐茚蝌狴篝蝈翥棼饼荏弭戾铉翳茚蝌狴泔祗屦拆酏茆彗轭狎蜥埕蓰祆沆蜢螨芰蜱芰蜱缮芰蜱缮芰蜱芍芰蜱莛蜷鲶翦痼苘芰蜱稚芰蜱稚芰蜱稚缮芰蜱韶芰蜱苠钿狎蜥ゥゥゥ义躞轭翳轶翦忪徙磲玳骘蝓铙燥蓬茴鬻泔眄犷潲茯躅笤锱钿酃蓰茕彐芰蜱甥１茕彐芰蜱缮２茕彐芰蜱缮甥３茕彐芰蜱芍４茕彐芰蜱蛀５茕彐芰蜱稚６胖盼轭皿翦茕彐芰蜱稚甥７茕彐芰蜱稚缮８茕彐芰蜱韶９茯躅笤锱钿蔑铘轭蹂茴鬻泔眄犷潲茯躅笤锱钿蔑铘轭蹂鄄蓰茕彐芰蜱佧１芾殒眙狎琨２芰蜱芑芰蜱缮芑芰蜱缮芑芰蜱芍芑芰蜱莛蜷鲶翦痼芰蜱稚芑芰蜱稚芑芰蜱稚缮芑芰蜱韶芑芰蜱茕彐茚蝌狴篝蝈翥棼饼荏弭戾铉翳茚蝌狴泔祗屦拆酏茆彗轭狎蜥祆沆蜢螨芰蜱芰蜱缮芰蜱缮芰蜱芍芰蜱莛蜷鲶翦痼苘芰蜱稚芰蜱稚芰蜱稚缮芰蜱韶芰蜱苠钿狎蜥ゥゥ蓬镦翦忪徙磲玳茴鬻泔眄犷潲茯蹯邋鲠忑鄞蓰１莒遽潴麸啕２３４茴鬻泔眄犷潲茔镱泸弭彐镱酏茼狒栝酏茴鬻泔眄犷潲茔镱泸弭弩礅镬ゥゥゥ茴鬻泔眄犷潲莒狒羧听苠铙躜屙狒茼狒梵纣忍澡痫轭舡灬趑殂茴鬻泔眄犷潲苠箝戾铘荇狨ッ群矧忮趑弪翎蹩哪痱彐弪翎茴鬻泔眄犷潲茚泗轱铨茚祓栳茴鬻泔眄犷潲茗蝓戾鄄蓰苕蜥沱１２茴鬻泔眄犷潲荇铋忑郯蓰苠铙躜屙狒棼苠痼殪镱矧茆蹯戾茴鬻泔眄犷潲荇泔铙鄄蓰苠铙躜屙狒棼１２茴鬻泔眄犷潲荏翦痱郯蓰茼狒栩屐茗蜷玷翎蝌秣茴鬻泔眄犷潲茯殓梏狎蝻黝矬翎螨郾蓰茼狒栩屐茗蜷玷翎蝌秣１茼狒栩屐荟痂犷麸睇荇稞茴鬻泔眄犷潲荏轭珈弩翦瘕鄢蓰１茯殓梏狎蝻黝矬翎螓２３茴鬻泔眄犷潲茯殓梏狎蝻黧翎螨郾蓰茼狒栩屐茗蜷玷翎蝌秣１茼狒栩屐荟痂犷麸睇荇稞捃篝狎茴鬻泔眄犷潲茼蹯糸篝屦鄢蓰１茯殓梏狎蝻黧翎螓２３茴鬻泔眄犷潲苕趄徙妪鄄蓰１茯殓梏狎蝻黧翎螓２茴鬻泔眄犷潲荛铋酏郾蓰苠铙躜屙狒棼茼狒栝酐深轸ǎ暴茴鬻泔眄犷潲荛铋翩郯蓰苠铙躜屙狒棼茼狒栝酐深轸茴鬻泔眄犷潲苌铋翩郾蓰苠铙躜屙狒棼荛铋翩ǎ暴茴鬻泔眄犷潲茼狒汨荇蜷犷珈弪殓梏茴鬻泔眄犷潲莒殒酏郾蓰茼狒栩屐埯１蔟茴鬻泔眄犷潲芡狒汨莒殒酐茼狒汨茴鬻泔眄犷潲芡狒汨觚郾蓰莒殒酐茼狒汨啕１茴鬻泔眄犷潲芡狒汨躞鄄蓰莒殒酐茼狒汨啕１摞２茴鬻泔眄犷潲芡狒汨豸郾蓰芡狒汨躞１苠箝戾铘茴鬻泔眄犷潲芡狒汨酏芡狒汨豸茴鬻泔眄犷潲茯雉狒邃秣铨郾蓰茼狒桠轭荇屮酐茯雉狒邂秫埏蜷玳罱爿拱ぃ堡茴鬻泔眄犷潲莒孱玺椠郾蓰荇屮趔纣戾铉翳ǎ暴茴鬻泔眄犷潲茯屙秭弩殪孱酏郾蓰苕殪翦螓苠箝戾铘１茴鬻泔眄犷潲苌眇扉弩鄄蓰１芑芴镱珧殓梏狎蝻鬈唬昌茴鬻泔眄犷潲芰钿轲芎荀邃珏芎茴鬻泔眄犷潲莛蜷鲶翎翦鄄蓰苠铙躜屙狒１摞２茴鬻泔眄犷潲苕殪翦螨鄄蓰苠铙躜屙狒棼莒骒镲２茯骒镲蜻１茴鬻泔眄犷潲苠耦蝈纨郾蓰ㄜ蝈纣１往篝弪轱躞屮犴痨骘躅镱翳藻郁徙砒汨犷珏麸潋狩溟徵蜥鏖翳蝈骒屮轹瀛趄犷箝糸鲥沆矬躜瀹荃箦疳汶徵妍糸膪荃箦痃骒殁蜥蝙痨雉磲螂簖荇殡箦酐麸篝戾禁箬矧翦窘驳屙１麸麸疳翳禁铒溴坶铑弪箦鸾梆衄狒孱洮箪镳邃蕺ㄜ糸膪麸翎蜱弭荇殡麸铒溴簖麸溴驷蹯艚荇殡箦酐麸氇篝戾禁箬矧翦窘驳屙１麸麸疳翳禁铒溴坶铑弪箦鸾梆衄狒孱洮箪镳邃捃篝狎啕荏臊ㄜ糸膪麸翎蜱弭荇殡麸铒溴簖麸氇溴驷蹯艚茼犭遽綮弭翦莛珂狎蝻黧溴沆狎妍麸麸莛珂豸殪吏屙痄轫峤爱复痿茚漩犷沐莛珂豸殪吏屙痄轫怡碑耻痃骒轭鬻殇翳莛珂豸殪吏屙痄轫饨爱脖痿茚漩犷沐莛珂豸殪吏屙痄轫怡恫弟痃骒轭鬻殇翳茚漩犷沐莛珂豸殪吏屙痄轫怡伯叼籁莛珂狎蝻黧戾骠屮翦钿莛珂豸殪吏屙痄轫猃莛珂狎蝻黧蜷玷翦翦钿莛珂豸殪吏屙痄轫恺莛珂豸殪吏屙痄轫峤爱哺痿茚漩犷沐莛珂豸殪吏屙痄轫怡耻痃骒轭鬻殇翳莛珂箦綮轭鬻殇翳爱杠痃骒轭鬻殇翳莛珂箦翡狍棼梆酏莛珂箦趄秕钿汜莛珂箦趄秕钿觑轭莛珂疳翳盹鲥麸莛珂耩镩铘耻痃骢糸炖翦眇溟磲窜痃骢糸炖翦眇溟磲莛珂疳翳沲蝣弭莛珂耩镩铘伯返莛珂豸殪吏屙痄轫猃伯弟痃骢糸炖翦眇溟磲莛珂耩镩铘梆酏爱驳莛珂豸殪吏屙痄轫猃莛珂耩镩铘爱返莛珂豸殪吏屙痄轫猃梆酏莛珂疳翳沲蝣弭莛珂耩镩铘梆酏爱驳莛珂豸殪吏屙痄轫猃莛珂耩镩铘伯返莛珂豸殪吏屙痄轫猃伯弟痃骢糸炖翦眇溟磲莛珂耩镩铘耻痃骢糸炖翦眇溟磲窜痃骢糸炖翦眇溟磲莛珂躞屦狒桉篝蝻脲茆彗轭珧秕莛珂趄犷箧矧眸箬殒酐伯叼酏莛珂趄犷箧矧睐箬殒酐拆酏莛珂趄犷箧矧眢汜戾俘莛珂躞屦祜繇狎臌狍翦蜷箅苠钿珧秕莛珂翦糅戾骠讲痿蓰ぼ筱蜷痿篝戾荃箦糸膪扉怛狎汜煦茴鬻泔眄犷潲茕蹴睐翎琮荃钿弪扉铄荑箴徙妍靛睚茴鬻泔眄犷潲茔轸迮翥予矧酏郾蓰荛骀蹯燔汩翦１苠祗遘汩翦坼翥蓰１苕辇茴鬻泔眄犷洫荛辇郾蓰荇屮糸酐１茼犭遽綮弭翦茴鬻溟礤钴闲孟呐鏖漪芟忻夏坯殇翳甸茴鬻溟礤钴艺膛鏖漪茴鬻泔眄犷潲茉艺琵荇屮酐荇趄蹂茴鬻泔眄犷潲芤仗琵酃蓰茜溴孳艺膛烈蚁荛骠桢铄祗妍苠聃犰７芤殓梏狎蝻鼾茯殓梏狎蝻鼾攘盟茜溴孳艺膛晌姓喳ǎ铂３４５６茜溴孳艺膛险孕赵ǎ脯９茜溴孳艺膛孟文荛骠桢铄祗妍苠聃犰７荛骠桢铄祗妍苠聃犰７茉艺琵茼狒栩睇芑殒芑７Ζ荑箴徙濯备靛睚荑怙麸遍荑怙麸芟忻夏坯殇翳荛骧Γ宝苠祗澶１ぼ苕辇渝栾忾轸轶镱镱扉铄荏弭怙芾翦眇怙荑怙ぼ艺膛晌姓芤仗帕乙献芤仗畔赵姓芤仗琶衔膜芤仗坯殇翳荀滠吏屙疴秫娘弩轸骈艨荛驿轫芤仗坯殇翳伯撮阵轸茆秫芾翦眇怙苠祗遘殒溟芤仗坯殇翳串搁絮轸镱赭扉铄荑箴徙濯碑冲睚茆彗轭狎蜥埕蓰利炖忑芤仗派涡赵苘芤仗帕乙献芤仗畔赵姓攒艺膛孟文苠钿狎蜥苠祗絮轸镱翳蝈扉铄荑箴徙濯碑冲睚茆彗轭狎蜥埕蓰利炖忑芤仗派涡赵苘芤仗帕乙献芤仗畔赵姓苘芤仗琶衔苠钿狎蜥苕檐骈茴鬻泔眄犷潲苡镣琵郾蓰Ζ荑箴徙濯备靛睚荑怙麸遍荑怙麸芟忻夏坯殇翳ぃ堡荏弭怙芾翦眇怙荑怙
      \RULEwidth \wd\@tempboxa
      \box\@tempboxa\nonumber
}}
\newcommand{\ORULE}[9]{
	\gdef\RULEARROW{\ifthenelse{\equal{#7}{}}{\Rightarrow}{\xrightarrow{1}}}  % HACK!
\gdef\RULEINPUT{(#2,#3,#4,#5,#6)}
\gdef\RULEOUTPUT{%
       (#8,#9)%
       \ifthenelse{\equal{#7}{}}{}%
                   {\ifthenelse{\equal{#7}{\TRUE}}{}%
                               {\mathrm{\;if\;}#7}}}
&& \hspace*{-18.5em}
  \hbox to 1in {
      \hbox to \OPCODEwidth {$#1$\ : }
      % See how big it is on one line
      \setbox \@tempboxa \hbox{$\RULEINPUT \RULEARROW \RULEOUTPUT$}
      \RULEwidth \wd\@tempboxa
      % Does it fit?
      \ifdim \RULEwidth < 2.6in
        % Use it
        \box\@tempboxa
      \else
        % Put it on two lines
        $ \hspace*{-1.3em}
        \begin{array}[t]{@{}l@{\ }l}
            & \RULEINPUT \\
            \RULEARROW
            & \RULEOUTPUT
        \end{array}
       $
     \fi
  }
}
\newcommand{\CRULE}[8]{%
  \RULE{#1}{#2}{}{#3}{#4}{#5}{#6}{#7}{#8}
}
\makeatother

\newcommand{\mem}[0]{\ii{mem}}
\newcommand{\imem}[0]{\ii{im}}
\newcommand{\dmem}[0]{\ii{dm}}
\newcommand{\reg}[0]{\ii{reg}}
\newcommand{\rd}[2]{#1[#2]}
\newcommand{\upd}[3]{#1[#2{\leftarrow}#3]}
\newcommand{\pc}[0]{\ii{pc}}
\newcommand{\epc}[0]{\ii{epc}\xspace}
\newcommand{\ra}[0]{\ii{ra}}
\newcommand{\tpc}[0]{t_\ii{pc}}
\newcommand{\tra}[0]{t_\ii{ra}}
\newcommand{\ti}[0]{t_\ii{i}}
\newcommand{\ks}[0]{\ii{ks}}
\newcommand{\extra}[0]{\ii{extra}}
\newcommand{\TRANSFER}{\ii{transfer}\xspace}
\newcommand{\EXTRASTATES}{\ii{EX}}
\newcommand{\cache}{\ii{cache}}
\newcommand{\SK}{\ii{SK}}
\newcommand{\iv}{\ii{iv}}
\newcommand{\ov}{\ii{ov}}
\newcommand{\step}[2]{\ensuremath{#1\to#2}}
\newcommand{\stepn}[2]{\ensuremath{#1\to_n#2}}
\newcommand{\stepa}[2]{\ensuremath{#1\to_a#2}}
\newcommand{\longstep}[2]{\begin{array}[t]{l@{\;}l}&#1\\\to&#2\end{array}}
\newcommand{\astat}[4]{\ensuremath{(#1,#2,#3\ifthenelse{\equal{#4}{}}{}{,#4})}}
\newcommand{\acfistat}[5]{\ensuremath{(#1,#2,#3,#4,#5)}}
\newcommand{\cstat}[5]{\ensuremath{(#1,#2,#3,#4,#5)}}
\newcommand{\stat}[5]{\ensuremath{(#1,#2,#3,#4,#5)}}
\newcommand{\rret}{r_{\!\ii{ret}}}
\newcommand{\rarg}[1]{r_{\!\ii{arg#1}}}
\newcommand{\old}{_{\mathit{old}}}
\newcommand{\undefined}{\uparrow}
\newcommand{\trapaddr}{\ii{trapaddr}}
\newcommand{\handler}[8]{\ii{transfer}(#1,#2,#3,#4,#5,#6) = (#7,#8)}
\newcommand{\rulelookup}[8]{%
   \cache \vdash (#1,#2,#3,#4,#5,#6) \mapsto (#7,#8)}
\newcommand{\rulelookupshort}[2]{%
   \cache \vdash #1 \mapsto #2}
\newcommand{\rulelookupmissshort}[1]{%
   \cache \vdash #1 \uparrow}
\newcommand{\rulelookupmiss}[6]{%
   \cache \vdash (#1,#2,#3,#4,#5,#6) \uparrow}
\newcommand{\savestate}[7]{%
  #7 [0..5 \leftarrow ({#1},{#2},{#3},{#4},{#5},{#6})]}
\newcommand{\savestateshort}[2]{%
  #2 [0..5 \leftarrow {#1}]}
\newcommand{\mapupd}{\uplus}

\newcommand{\VData}[1]{#1}%\ii{VWord}\newcommand{\VKey}[1]{#1} % \ii{VKey}\newcommand{\VSealed}[2]{\{#1\}_{#2}}
\newcommand{\VPtr}[1]{#1}

\newcommand*{\Compartments}{C}
\newcommand*{\AddressSpace}{A}
\newcommand*{\JumpTargets}{J}
\newcommand*{\StoreTargets}{S} 
\newcommand*{\compartment}{c}
\newcommand*{\pointer}{p}
\newcommand*{\Ccompartment}{c}
\newcommand*{\CIncoming}{I}
\newcommand*{\CWriters}{W}
\newcommand*{\stepkind}{F}
\newcommand*{\Cpcstate}{F}
\newcommand*{\INTERNAL}{\ii{Internal}}
\newcommand*{\JUMPED}{\ii{Jumped}}
\newcommand*{\tPC}[2]{\langle#1,#2\rangle}
\newcommand*{\tDATA}[3]{\langle#1,#2,#3\rangle}
\newcommand*{\tREG}{\ii{Reg}}
\newcommand*{\tIsolate}{t_{\ii{I}}}
\newcommand*{\tAddJ}{t_{\ii{AJ}}}
\newcommand*{\tAddS}{t_{\ii{AS}}}

\newcommand{\DATA}[0]{\ii{Data}}
\newcommand{\KEYname}[0]{\ii{Key}}
\newcommand{\KEY}[1]{\KEYname#1}
\newcommand{\SEALED}[1]{\ii{Sealed}#1}
\newcommand{\INSTRname}[0]{\ii{Instr}}
\newcommand{\INSTR}[1]{\INSTRname#1}

\newcommand{\USERname}[0]{\ii{User}}
\newcommand{\USER}[1]{\USERname#1}
\newcommand{\MONITOR}[0]{\ii{Monitor}}
\newcommand{\ENTRYname}[0]{\ii{Entry}}
\newcommand{\ENTRY}[1]{\ENTRYname#1}
\newcommand{\enc}[1]{\ii{enc}#1}

\let\oldunderscore=\_
\def\_{\oldunderscore\hspace{1.5pt}}

\newenvironment{tightenumerate}{%
  \iffull
    \begin{enumerate}
  \else
    \begin{enumerate*}[label=(\arabic*)]
  \fi
}{
  \iffull
    \end{enumerate}
  \else
    \end{enumerate*}%
  \fi
}

\newenvironment{tightenumeratealpha}{%
  \iffull
    \begin{enumerate}
  \else
    \begin{enumerate*}[label=(\alph*\upshape)]
  \fi
}{
  \iffull
    \end{enumerate}
  \else
    \end{enumerate*}%
  \fi
}

\newcommand{\citeFull}[2]{\iffull\cite{#1,#2}\else\cite{#1}\fi}

\newcommand{\RULEWITHPREMISE}[9]{
\typicallabel{}
  \infrule{#7}{\ii{#1} : (#2, #3, #4, #5, #6) \to (#8,#9)}
\typicallabel{MkKey}
}
